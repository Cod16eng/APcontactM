<!DOCTYPE html>
<html>
  <head>
    <title>APcontactM</title>
    <%= csrf_meta_tags %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
  	<!-- navbar -->
    <nav class="navbar navbar-dark bg-primary navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>

          <%= link_to "Contact Manager", root_path, class: "navbar-brand text-uppercase" %>

        </div>
        <!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="navbar-collapse">

          <div class="nav navbar-right navbar-btn">
            <% if user_signed_in? %>
            <%= link_to "Collaboration",  search_contacts_path, class: "btn btn-default"  %>

            <%= link_to new_contact_path, class: "btn btn-default" do %>
              <i class="glyphicon glyphicon-plus"></i> <strong>Add Contact</strong>
              <%end%>

              <%= link_to current_user.full_name, edit_user_registration_path, class: "btn btn-info"  %>
              <%= link_to destroy_user_session_path, method: :delete, class: "btn btn-default" do %>
               <strong>Logout</strong>
              <% end %>
              <%else%>


              <% end %>

          </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- content -->
    <div class="container">
      <% if user_signed_in? %>
      <%  if params[:controller] == 'contacts' && params[:action] == 'index' || params[:action] == 'show' || params[:action] == 'edit'%>
      <div class="row">

          <form class="navbar-form navbar-right">
            <%= form_tag contacts_path, method: :get do %>
          <div class='form-group'>
            <%= text_field_tag :search, params[:search], class: "form-control ", placeholder: "Search Contact" %>
               <%= submit_tag 'Search', name: nil, class: "btn btn-primary" %>
               </div>
               </form>
          <% end %>
        <div class="col-md-3 col-sm-6">

          <div class="list-group">
            <!-- set active links-->
            <% active = params[:group_id] == nil ? 'active' : '' %>

            <%= link_to contacts_path, class: "list-group-item #{active}" do %>
              All Contacts<span class="badge"><%= Contact.count %></span>
            <% Group.all.each do |group| %>
            <% active = params[:group_id].to_i == group.id ? 'active' : '' %>
            <%= link_to contacts_path(group_id: group.id), class: "list-group-item #{active}" do %>
             <%= group.name %><span class="badge"><%= group.contacts.count %></span>
            <% end %>
            <% end %>
            <% end %>
            <% end %>

          </div>

        </div><!-- /.col-md-3 -->
         <% end %>

        <div class="col-md-9 col-sm-7">

          <%flash.each do |type, message| %>
          <%= content_tag :div, class: "alert alert-#{type} alert-dismissible", role: "alert" do %>
          <button type="button" class= close data-dismiss="alert" aria-label= "Close" ><span aria-hidden= "true" > &times; </span></button>
          <%= message %>
          <% end %>
          <% end %>



        	<%= yield %>
          <%= debug(params) if Rails.env.development? %>
        </div>



    </div>



  </body>
</html>
